using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using DevExpress.XtraEditors;
using System.Data;
using BLL.<<<Database_Name>>>_BLL.<<<Main_Table>>>;


namespace PRESENTATION_LAYER.<<<Database_Name>>>_PRESENTATION_LAYER.Forms.<<<Main_Table>>>
{
   public class cls_<<<Main_Table>>>_P
    {
        
        Boolean isAllowedInsertion = true, isAllowedUpdation = true, isAllowedDeletion = true, isDisturebedOnce = false, isAutoGeneratedOption = <<<IsAutoGenerateOptionVisible>>>;
        
        GEN.GEN_GEN.GenericClasses.Form.Gen_Form ObjGenForm;
        
        GEN.GEN_GEN.GenericClasses.cls_MessageBox obj_cls_MessageBox = new GEN.GEN_GEN.GenericClasses.cls_MessageBox();
        
        DATASET.<<<Database_Name>>>_DATASET.cls_DataSet obj_cls_DataSet_<<<Database_Name>>> = new DATASET.<<<Database_Name>>>_DATASET.cls_DataSet();
        
        GEN.GEN_GEN.Look.frlLOOKUP obj_frlLOOKUP = null;
        
        BLL.<<<Database_Name>>>_BLL.<<<Main_Table>>>.cls_<<<Main_Table>>> obj_cls_<<<Main_Table>>> = new BLL.<<<Database_Name>>>_BLL.<<<Main_Table>>>.cls_<<<Main_Table>>>();
        
        frm_<<<Main_Table>>> obj_frm_<<<Main_Table>>> = null;
        
        DataTable dt_Datanavigator = new DataTable();

        void InitializeComponents(frm_<<<Main_Table>>> pobj_frm_<<<Main_Table>>>, String pID )
         {

            obj_frm_<<<Main_Table>>> = pobj_frm_<<<Main_Table>>>;
            GEN.GEN_GEN.GenericClasses.cls_CustomeForm.applyPropertiesOnXtraForm(obj_frm_<<<Main_Table>>> , 'A');
            obj_cls_<<<Main_Table>>>.obj_XtraForm = pobj_frm_<<<Main_Table>>>;
              
            if (!obj_cls_<<<Main_Table>>>.Open())
                obj_frm_<<<Main_Table>>>.Close();

          

            if (pID == "N")
                Referesh("True");
            else
             {
                 obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.Text = pID;

                 selection("V", obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.Text.Trim());

            }

         }


        public cls_<<<Main_Table>>>_P(frm_<<<Main_Table>>> pobj_frm_<<<Main_Table>>>, String pID, GEN.GEN_GEN.GenericClasses.Form.Gen_Form pObjGenForm , bool pIs_DisturbanceOnce)//VVVParamVVV
        {
            ObjGenForm = pObjGenForm;
            isDisturebedOnce = pIs_DisturbanceOnce;
            InitializeComponents(pobj_frm_<<<Main_Table>>>, pID);
          
        }

string validateChild()
            {
                  string validateStatus = "ok";

                 

                  return validateStatus;


            }



        public bool validate(out string value, bool pIs_Delete)
        {
            if (pIs_Delete)
            {

                if (!isAllowedDeletion)
                {
                    value = obj_cls_MessageBox.error_delete_rights;
                    return false;

                }

                if (obj_frm_<<<Main_Table>>>.DBStatus == 'I')
                {
                    value = obj_cls_MessageBox.error_selection_msg;
                    return false;
                }

            }
            else
            {
                if (obj_frm_<<<Main_Table>>>.DBStatus == 'I')
                {
                    if (!isAllowedInsertion)
                    {
                        value = obj_cls_MessageBox.error_insert_rights;
                        return false;

                    }

                }
                if (obj_frm_<<<Main_Table>>>.DBStatus == 'U')
                {
                    if (!isAllowedUpdation)
                    {
                        value = obj_cls_MessageBox.error_update_rights;
                        return false;

                    }

                }


string validateChildValue = validateChild();

                        if (validateChildValue != "ok")
                        {
                              value = validateChildValue;
                              return false;

                        }


                
            }

            if(obj_frm_<<<Main_Table>>>.DBStatus == 'U')
                if (Convert.ToString(obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.EditValue) == "")
                {
                    value = obj_cls_MessageBox.error_ID_msg;
                    return false;
                }
            if (obj_frm_<<<Main_Table>>>.DBStatus == 'I')
                if (!obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Checked && Convert.ToString(obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.EditValue) == "")
                {
                    value = obj_cls_MessageBox.error_ID_msg;
                    return false;
                }
           




            value = "N";
            return true;
        }




      public void getMax()
        {
		
		 try
            {
		
           if (obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Checked)
             {

                int tempID = obj_cls_DataSet_<<<Database_Name>>>.f_GETMAX("<<<Main_Table>>>", 0, 0, 0, "", "", "");
                obj_frm_<<<Main_Table>>>.maxID =  tempID.ToString();
                obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.Text = obj_frm_<<<Main_Table>>>.maxID;
            
             }
			   }
            catch (Exception ex)
            { 
            
            }
        }



       public void loadGridLookUpEdit(string Status)
        { 
         
               <<<BindingGridLookUpEdit>>>
        
        }

         public string valueGetting(bool pIs_Delete)
          {

            try
            {

              string validate_value = "";

                if (!validate(out validate_value, pIs_Delete))
                {
                    
                    if(validate_value == "N" )
                        return "V_P";
                    else
                        return validate_value;

                }
                 
                if (pIs_Delete)
                {
                    obj_cls_<<<Main_Table>>>.STATUS = "D";
                    obj_cls_<<<Main_Table>>>.<<<Primary_Key>>> = Convert.ToString(obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.EditValue);
                }
                {

                  obj_cls_<<<Main_Table>>>.Is_Auto_Generated = obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Checked;
                  
                   if (obj_frm_<<<Main_Table>>>.DBStatus == 'I')
                    {

                      if (!obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Checked)
                      obj_cls_<<<Main_Table>>>.<<<Primary_Key>>> = Convert.ToString(obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.EditValue);
                    } 
                    else
                        obj_cls_<<<Main_Table>>>.<<<Primary_Key>>> = Convert.ToString(obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.EditValue);
               
<<<Getting_Values>>>
                    

                }
               


            }
            catch (Exception ex)
            {

                return ex.Message;

            }

            return "ok";
        
        }
         public string valueSetting( DataSet ds)
          {

            try
            {
                 
                DataTable dt_Main = ds.Tables[0];

                obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Checked = (Boolean)dt_Main.Rows[0][ GEN.GEN_GEN.GenericClasses.cls_GENGlobalClass.Is_Auto_Generated];
                

<<<Setting_Values>>>
                  
                obj_frm_<<<Main_Table>>>.DBStatus = 'U';
                obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Enabled = false;
            }
            catch (Exception ex)
            {

                return ex.Message;

            }

            return "ok";
        
          }


      public void Referesh(String isComplete)
        {
            
            if (isComplete == "True")
             {
                
               //try
                //{
                //    //DataRow[] drr = MDIClassic.dtRightsButton.Select(" [Parent Key] = '" + obj_frm_TBL_PRODUCTS_2.Tag + "'");
                //    foreach (DataRow d in drr)
                //    {
                //        if (GEN.GEN_GEN.GenericClasses.UserRIghts.cls_RightsKeys.key_del == d["Primary Key"].ToString())
                //        {
                //            isAllowedDeletion = true;
                //        }
                //        else if (GEN.GEN_GEN.GenericClasses.UserRIghts.cls_RightsKeys.key_insert == d["Primary Key"].ToString())
                //        {
                //            isAllowedInsertion = true;
                //        }
                //        else if (GEN.GEN_GEN.GenericClasses.UserRIghts.cls_RightsKeys.key_update == d["Primary Key"].ToString())
                //        {
                //            isAllowedUpdation = true;
                //        }
                //    }

                //}
                //catch (Exception ex)
                //{
                //    //throw;
                //}


               <<<loadGridLookUpEdit>>>
               
               obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Visible = isAutoGeneratedOption;
               
               if (!isAllowedInsertion && !isAllowedUpdation)
                   obj_frm_<<<Main_Table>>>.SimpleButton_Save.Enabled   = false;
               if (!isAllowedDeletion)
                   obj_frm_<<<Main_Table>>>.SimpleButton_Delete.Enabled = false;
                   
               selection("N", "");
               Referesh("False");               
 
             }
              else if (isComplete == "Partial")
            {
                selection("N", "");
                Referesh("False");               
                
            }

            
            ObjGenForm.GenRefresh();
            obj_frm_<<<Main_Table>>>.DBStatus = 'I';
            obj_frm_<<<Main_Table>>>.CheckEdit_Is_AutoGenegereted.Enabled = true;
            //obj_frm_<<<Main_Table>>>.CheckEdit_navigate.Checked = false;
            getMax();
            
         }

    public void Delete()
        {

            string executeFunctions = valueGetting(true);

            if (executeFunctions != "ok")
            {
                if (executeFunctions != "N")
                {
                    if (executeFunctions == "V_P")
                    {
                        obj_cls_MessageBox.MessageBoxStatic("VP_E");
                        return;
                    }
                    else
                    {
                        obj_cls_MessageBox.MessageBoxDynamics(executeFunctions, "I_E");
                        return;

                    }
                }
            }


            if (obj_cls_MessageBox.MessageBoxStatic("D_Q") == "no")
            {

                return;

            }




            
            obj_cls_<<<Main_Table>>>.<<<Primary_Key>>> = obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.Text;

            if (obj_cls_<<<Main_Table>>>.deletion())
            {
                Referesh("Partial");
                if (isDisturebedOnce)
                    obj_frm_<<<Main_Table>>>.Close();
            }
              
        }

   public void Save()
        {


            string executeFunctions =  valueGetting(false);
             
            if (executeFunctions != "ok")
                {
                    if (executeFunctions != "N")
                    {
                        if (executeFunctions == "V_P")
                        {
                            obj_cls_MessageBox.MessageBoxStatic("VP_E");
                            return;
                        }
                        else
                        {
                            obj_cls_MessageBox.MessageBoxDynamics(executeFunctions, "I_E");
                            return;

                        }
                    }
                }

            if (obj_frm_<<<Main_Table>>>.DBStatus == 'I')
            {

                    if (obj_cls_MessageBox.MessageBoxStatic("I_Q") == "no")
                    {
                        return;
                    }

                    if (obj_cls_<<<Main_Table>>>.insertionUpdation('I'))
                    {
                        Referesh("Partial");
                        if (isDisturebedOnce)
                            obj_frm_<<<Main_Table>>>.Close();
                    }

                
            }

            else if (obj_frm_<<<Main_Table>>>.DBStatus == 'U')
            {

                 if (obj_cls_MessageBox.MessageBoxStatic("U_Q") == "no")
                    {
                        return;
                    }

                    if (obj_cls_<<<Main_Table>>>.insertionUpdation('U'))
                    {
                        Referesh("Partial");
                        if (isDisturebedOnce)
                            obj_frm_<<<Main_Table>>>.Close();
                    }
            }

        }

       public void selection(string pStatus, string pId)
        {

            if (pStatus == "N")
            {

/*           
                if (pId == "")
                {
                    obj_cls_DataSet_<<<Database_Name>>>.f_<<<Main_Table>>>("L", pId);
                    DataSet ds = obj_cls_DataSet_<<<Database_Name>>>.g_<<<Main_Table>>>;
                    if (ds == null)
                    {
                        obj_cls_MessageBox.MessageBoxStatic("BLL_E");
                        Referesh("False");
                        return;

                    }

                    dt_Datanavigator = ds.Tables[0].Copy();
                    obj_frm_<<<Main_Table>>>.DataNavigator_Navigate.DataSource = dt_Datanavigator;

                }
                else
                {

                    string ID = dt_Datanavigator.Rows[Convert.ToInt32(pId)][cls_C<<<Main_Table>>>.pri<<<Primary_Key>>>].ToString();
                    selection("V", ID);
                }

*/
            }
            else if(pStatus == "A")
            {
                
                obj_cls_DataSet_<<<Database_Name>>>.f_<<<Main_Table>>>("A", pId);
                DataSet ds = obj_cls_DataSet_<<<Database_Name>>>.g_<<<Main_Table>>>;

                if (ds == null)
                {
                    obj_cls_MessageBox.MessageBoxStatic("BLL_E");
                    Referesh("False");
                    return;

                }

                
                obj_frlLOOKUP = new GEN.GEN_GEN.Look.frlLOOKUP(ds , 4, true,"150,<<<Columns_Length_For_LookUpForm_In_Selection>>>",1);
                obj_frlLOOKUP.ShowDialog();
                string value = GEN.GEN_GEN.Look.frlLOOKUP.value;
                if (value != "")
                {
                   string[] cols_values = value.Split('|');
                   obj_frm_<<<Main_Table>>>.CheckEdit_navigate.Checked = false;
                   selection("V",cols_values[0]);
                }

            }
            else 
            {

              obj_frm_<<<Main_Table>>>.maxID = obj_frm_<<<Main_Table>>>.TextEdit_<<<Primary_Key>>>.Text= pId;
              obj_cls_DataSet_<<<Database_Name>>>.f_<<<Main_Table>>>("V", pId);
              DataSet ds = obj_cls_DataSet_<<<Database_Name>>>.g_<<<Main_Table>>>;
              string executeFunctions = "";

               if (!GEN.GEN_GEN.GenericClasses.DataTables.cls_NativDataSet.checkIsNullIsNoTableIsTableEmpty(ds, 0) )

                      {
                          executeFunctions = valueSetting(ds);
                      }
                      else
                      {

                          obj_cls_MessageBox.MessageBoxStatic("TB_E");
                           Referesh("False");
                          return;

                      }
                 
              
                if ( executeFunctions!= "ok")
             
                {
                     obj_cls_MessageBox.MessageBoxDynamics(executeFunctions, "S_E");
                     return;

                   Referesh("False");

              
                }
              

            }

        }

     

     //VVVGRIDINFOVVV



    }
}
